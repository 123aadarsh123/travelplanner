<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Your Seat</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #fafbfc;
            margin: 0;
        }

        .progress-bar {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5em;
            margin: 32px 0 24px 0;
            font-size: 1.1em;
        }

        .progress-step {
            color: #0071c2;
            font-weight: 500;
        }

        .progress-step.done {
            color: #007a1c;
        }

        .progress-step.current {
            color: #005fa3;
            font-weight: 700;
        }

        .progress-sep {
            color: #bbb;
            margin: 0 8px;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 24px;
        }

        .flex-row {
            display: flex;
            gap: 32px;
        }

        .main-card {
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 2px 16px #0001;
            padding: 28px 28px 18px 28px;
            flex: 2;
        }

        .price-details {
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 2px 16px #0001;
            padding: 28px 28px 18px 28px;
            flex: 1;
            min-width: 320px;
        }

        .section-title {
            font-size: 1.6em;
            font-weight: 600;
            margin-bottom: 18px;
        }

        .trip-summary {
            color: #666;
            font-size: 1em;
            margin-bottom: 8px;
        }

        .flight-segment {
            margin-bottom: 24px;
            border-bottom: 1px solid #eee;
            padding-bottom: 18px;
        }

        .flight-segment:last-child {
            border-bottom: none;
        }

        .flight-segment-title {
            font-weight: 600;
            margin-bottom: 6px;
        }

        .flight-segment-details {
            color: #444;
            margin-bottom: 6px;
        }

        .select-seats-link {
            color: #0071c2;
            text-decoration: underline;
            cursor: pointer;
            font-size: 1em;
        }

        .no-seats {
            color: #888;
            margin-bottom: 6px;
        }

        .price-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .total-row {
            font-size: 1.3em;
            font-weight: 700;
            margin: 18px 0 8px 0;
            display: flex;
            justify-content: space-between;
        }

        .btn-row {
            display: flex;
            justify-content: flex-end;
            gap: 18px;
            margin-top: 32px;
        }

        .btn {
            border: none;
            border-radius: 7px;
            padding: 10px 32px;
            font-size: 1.1em;
            font-weight: 500;
            cursor: pointer;
        }

        .btn-back {
            background: #fff;
            color: #0071c2;
            border: 1px solid #0071c2;
        }

        .btn-skip {
            background: #0071c2;
            color: #fff;
        }

        @media (max-width: 900px) {
            .flex-row {
                flex-direction: column;
                gap: 0;
            }

            .main-card,
            .price-details {
                min-width: 0;
                width: 100%;
                margin-bottom: 18px;
            }
        }
    </style>
</head>

<body>
    <div class="progress-bar">
        <span class="progress-step done">Ticket type</span>
        <span class="progress-sep">─────────────</span>
        <span class="progress-step done">Your details</span>
        <span class="progress-sep">─────────────</span>
        <span class="progress-step done">Extras</span>
        <span class="progress-sep">─────────────</span>
        <span class="progress-step current">Select your seat</span>
        <span class="progress-sep">─────────────</span>
        <span class="progress-step">Check and pay</span>
    </div>
    <div class="container">
        <div class="trip-summary" id="trip-summary"></div>
        <div class="section-title" id="route-title"></div>
        <div class="flex-row">
            <div class="main-card">
                <div style="font-size:1.2em;font-weight:600;margin-bottom:18px;">Select your seat</div>
                <div class="flight-segment">
                    <div class="flight-segment-title">New Delhi - Mumbai</div>
                    <div class="flight-segment-details">2h 10m &middot; IndiGo</div>
                    <div class="no-seats">No seats selected</div>
                    <div><span class="select-seats-link">Select seats from INR0.00</span></div>
                </div>
                <div class="flight-segment">
                    <div class="flight-segment-title">Mumbai - New Delhi</div>
                    <div class="flight-segment-details">1h 55m &middot; IndiGo</div>
                    <div class="no-seats">No seats selected</div>
                    <div><span class="select-seats-link">Select seats from INR0.00</span></div>
                </div>
            </div>
            <div class="price-details">
                <div style="font-size:1.2em;font-weight:600;margin-bottom:18px;">Price details</div>
                <div style="color:#666;font-size:1em;margin-bottom:8px;" id="flight-travelers"></div>
                <div class="price-row" id="price-row"></div>
                <div class="total-row" id="total-row"></div>
                <div style="font-size:0.97em; color:#666; margin-top:10px;">Includes taxes and fees</div>
                <div style="margin-top:10px; color:#007a1c; font-size:0.97em;">
                    ✓ No hidden fees – track your price at every step
                </div>
            </div>
        </div>
        <div class="btn-row">
            <button class="btn btn-back">&lt; Back</button>
            <button class="btn btn-skip">Skip</button>
        </div>
    </div>
    <!-- Seat Selection Modal -->
    <div id="seat-modal"
        style="display:none;position:fixed;z-index:1000;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.18);align-items:center;justify-content:center;">
        <div
            style="background:#fff;border-radius:12px;min-width:320px;max-width:95vw;padding:32px 28px 18px 28px;box-shadow:0 2px 16px #0002;position:relative;">
            <span id="close-seat-modal"
                style="position:absolute;right:18px;top:12px;font-size:1.6rem;color:#888;cursor:pointer;">&times;</span>
            <div style="font-weight:600;font-size:1.2em;margin-bottom:18px;" id="seat-modal-title">Select seat</div>
            <form id="seat-form">
                <label style="font-size:1em;">Choose your seat:</label>
                <select id="seat-select"
                    style="width:100%;padding:10px;border:1px solid #bbb;border-radius:6px;font-size:1rem;margin:16px 0 24px 0;">
                    <option value="">-- Select --</option>
                    <option value="1A">1A (Window)</option>
                    <option value="1B">1B (Middle)</option>
                    <option value="1C">1C (Aisle)</option>
                    <option value="2A">2A (Window)</option>
                    <option value="2B">2B (Middle)</option>
                    <option value="2C">2C (Aisle)</option>
                </select>
                <div style="display:flex;justify-content:flex-end;">
                    <button type="button" id="seat-done-btn"
                        style="background:#0071c2;color:#fff;border:none;border-radius:7px;padding:10px 32px;font-size:1.1em;font-weight:500;cursor:pointer;">Done</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        window.addEventListener("DOMContentLoaded", function () {
            // Fetch from sessionStorage
            const adults = parseInt(sessionStorage.getItem("bookingAdults") || "1", 10);
            const children = parseInt(sessionStorage.getItem("bookingChildren") || "0", 10);
            const travelerCount = adults + children;
            const from = sessionStorage.getItem("bookingFrom") || "DEL";
            const to = sessionStorage.getItem("bookingTo") || "BOM";
            const journeyType = sessionStorage.getItem("bookingJourneyType") || "round-trip";
            const departure = sessionStorage.getItem("bookingDeparture") || "";
            const returnDate = sessionStorage.getItem("bookingReturn") || "";
            const fare = parseFloat(sessionStorage.getItem("bookingFare") || "0");

            // Airport code to name
            const airportNames = {
                DEL: "New Delhi",
                BOM: "Mumbai",
                BLR: "Bangalore",
                MAA: "Chennai",
                CCU: "Kolkata",
            };

            // Format date as: Sat, Jun 28
            function formatDate(dateStr) {
                if (!dateStr) return "-";
                const d = new Date(dateStr);
                if (isNaN(d)) return dateStr;
                return d.toLocaleDateString("en-US", {
                    weekday: "short",
                    month: "short",
                    day: "numeric",
                });
            }

            // Update trip summary
            document.getElementById("trip-summary").innerHTML = `
            ${journeyType === "round-trip" ? "Round-trip" : "One-way"}
            &nbsp;•&nbsp; ${travelerCount} traveler${travelerCount > 1 ? "s" : ""}
            &nbsp;•&nbsp; ${formatDate(departure)}${journeyType === "round-trip" && returnDate ? " - " + formatDate(returnDate) : ""}
            `;
            // Dynamic segment titles
            const fromName = airportNames[from] || from;
            const toName = airportNames[to] || to;

            // Update route title
            document.getElementById("route-title").textContent = `${fromName} to ${toName}`;

            // Update flight segment titles/details
            const segments = document.querySelectorAll('.flight-segment');
            if (journeyType === "round-trip" && segments.length === 2) {
                // Outbound
                segments[0].querySelector('.flight-segment-title').textContent = `${fromName} - ${toName}`;
                // Inbound
                segments[1].querySelector('.flight-segment-title').textContent = `${toName} - ${fromName}`;
            } else if (segments.length >= 1) {
                // One-way
                segments[0].querySelector('.flight-segment-title').textContent = `${fromName} - ${toName}`;
                if (segments[1]) segments[1].style.display = "none";
            }


            // Update price details
            document.getElementById("flight-travelers").textContent =
                `Flight (${travelerCount} traveler${travelerCount > 1 ? "s" : ""})`;
            document.getElementById("price-row").innerHTML = adults > 0 ?
                `<span>Adults (${adults})</span><span>INR${(fare).toLocaleString(undefined, {minimumFractionDigits:2})}</span>` :
                "";
            document.getElementById("total-row").innerHTML =
                `<span>Total</span><span>INR${fare.toLocaleString(undefined, {minimumFractionDigits:2})}</span>`;



            let currentSegment = null;

            // Open modal on "Select seats" click
            document.querySelectorAll('.select-seats-link').forEach((el, idx) => {
                el.addEventListener('click', function () {
                    currentSegment = idx;
                    document.getElementById('seat-modal').style.display = 'flex';
                    document.getElementById('seat-modal-title').textContent =
                        idx === 0 ? 'Select seat for New Delhi - Mumbai' :
                        'Select seat for Mumbai - New Delhi';
                    document.getElementById('seat-select').value = "";
                });
            });

            // Close modal
            document.getElementById('close-seat-modal').onclick = function () {
                document.getElementById('seat-modal').style.display = 'none';
            };

            // Done button
            document.getElementById('seat-done-btn').onclick = function () {
                const seat = document.getElementById('seat-select').value;
                if (!seat) {
                    alert('Please select a seat.');
                    return;
                }
                // Update seat info in the main card
                const segments = document.querySelectorAll('.flight-segment');
                const noSeats = segments[currentSegment].querySelector('.no-seats');
                noSeats.textContent = 'Seat selected: ' + seat;
                document.getElementById('seat-modal').style.display = 'none';
            };
        });
    </script>
</body>

</html>